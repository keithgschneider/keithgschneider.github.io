import{d as D,P as se,u as w,s as P,c,o,a as i,b as u,n as R,Z as z,_ as T,e as te,t as M,f as I,F,r as V,g as ne,h as W,S as G,i as L,p as j,j as H,C as N,k as E,O as oe,T as ae,l as K,m as J,q as le,v as ce,w as re,B as ie}from"./index-6814e549.js";const _e=["id"],fe=D({__name:"PlaceComp",props:{place:{type:se,default:null},hidden:{type:Boolean,default:!1},corner:{type:Boolean,default:!1}},setup(s){const e=s,n=w(),{altar:p,getSelectedOfferings:_,getHeldOffering:g}=P(n),m=c(()=>e.place?e.place.getID():""),v=c(()=>{var t;return(t=p.value)==null?void 0:t.getOpenPlaces().includes(e.place)}),b=c(()=>_.value.length&&v.value),d=c(()=>{var t;return((t=e.place)==null?void 0:t.zone)!==z.Altar});function h(){if(e.place.type==="omen"||e.place.zone!==z.Altar)return;const t=g.value;t&&n.pushOfferingAtPlace(e.place,t.direction)}function C(t){e.place.type==="omen"||e.place.zone!==z.Altar||(n.resetOfferings(),t.preventDefault())}function $(t){t.dataTransfer&&(t.dataTransfer.dropEffect="link"),t.preventDefault()}function x(t){e.place.type==="omen"||e.place.zone!==z.Altar||(n.dropOffering(e.place),t.preventDefault())}return(t,a)=>{var l;return o(),i("div",{id:m.value,class:R(["place",[(l=e.place)==null?void 0:l.type,s.hidden?"invisible":"",s.corner?"corner":"",b.value?"enabled":"",d.value?"spread":""]])},[u("div",{class:"spacing",onDragenter:h,onDragleave:C,onDragover:$,onDrop:x},null,32)],10,_e)}}});const U=T(fe,[["__scopeId","data-v-9b7cef24"]]),ge=s=>(j("data-v-c88a4b1b"),s=s(),H(),s),ue=ge(()=>u("br",null,null,-1)),de={key:0},pe={key:1},me={class:"digits"},ve=D({__name:"PlayerComp",props:{player:{type:te,default:null}},setup(s){const e=s,n=w(),{getTurnPhaseString:p,getCurrentPlayerTurn:_}=P(n),g=c(()=>e.player?e.player.getRows():[]),m=c(()=>n.getPlayerFortunes(e.player.id)),v=N.fortuneMajor,b=c(()=>m.value.find(h=>h.length===v)),d=c(()=>e.player.turn&&_.value);return(h,C)=>s.player?(o(),i("div",{key:0,class:R(["player flex-column-center",d.value?"turn":""])},[u("h2",null,M(I(G).player)+" "+M(s.player.id),1),ue,s.player.turn?(o(),i("h3",de,M(I(p)),1)):(o(),i("p",pe,M(I(G).waiting),1)),(o(!0),i(F,null,V(g.value,($,x)=>(o(),i("div",{key:x,class:"flex-row-center"},[(o(!0),i(F,null,V($,(t,a)=>(o(),L(U,{key:a,place:t,hidden:x===0},null,8,["place","hidden"]))),128))]))),128)),u("h3",null,[ne(M(I(G).fortunes.toUpperCase())+": ",1),u("span",me,M(m.value.length)+M(b.value?"*":""),1)])],2)):W("",!0)}});const q=T(ve,[["__scopeId","data-v-c88a4b1b"]]),ye={class:"limbo flex-column-center"},be={class:"flex-row-center"},he=D({__name:"LimboComp",setup(s){const e=w(),{limbo:n}=P(e),p=c(()=>{var _;return(_=n.value)==null?void 0:_.getRow()});return(_,g)=>(o(),i("div",ye,[u("div",be,[(o(!0),i(F,null,V(p.value,(m,v)=>(o(),L(U,{key:v,place:m,hidden:""},null,8,["place"]))),128))])]))}}),$e={class:"flex-row-center"},Oe={class:"flex-column-center"},Ie={class:"altar flex-column-center shadow"},xe=D({__name:"AltarComp",setup(s){const e=w(),{altar:n}=P(e),p=c(()=>{var _;return(_=n.value)==null?void 0:_.getRows()});return(_,g)=>(o(),i("div",$e,[u("div",Oe,[u("div",Ie,[(o(!0),i(F,null,V(p.value,(m,v)=>(o(),i("div",{key:v,class:"flex-row-center"},[(o(!0),i(F,null,V(m,(b,d)=>(o(),L(U,{key:d,place:b,corner:(v===0||v===I(N).altarSize-1)&&(d===0||d===I(N).altarSize-1),hidden:""},null,8,["place","corner"]))),128))]))),128))])])]))}});const Ce=T(xe,[["__scopeId","data-v-9f2ee722"]]),De=s=>(j("data-v-cb5325e4"),s=s(),H(),s),we={class:"kitty flex-column-center shadow"},Pe=De(()=>u("div",{class:"spacing"},null,-1)),ke=D({__name:"KittyComp",setup(s){const e=w(),{kitty:n}=P(e);return(p,_)=>{var g;return o(),i("div",we,[Pe,E(U,{place:(g=I(n))==null?void 0:g.place,hidden:""},null,8,["place"])])}}});const Be=T(ke,[["__scopeId","data-v-cb5325e4"]]),Ee="/assets/11-fabe0405.png",Te="/assets/12-3cf8e2ab.png",Ae="/assets/13-8257758d.png",Se="/assets/14-57ec94eb.png",Me="/assets/21-0ee2c953.png",ze="/assets/22-886470d6.png",Re="/assets/23-03cfa18c.png",Fe="/assets/24-cc251532.png",Ve="/assets/31-def237dc.png",Le="/assets/32-9efe663d.png",Xe="/assets/33-8f8ea4f7.png",Ye="/assets/34-7c1afc5b.png",je="/assets/41-0b26d785.png",He="/assets/42-a824f74a.png",Ue="/assets/43-465307d6.png",Ge="/assets/44-7ac05cfb.png",Ne=["id"],Ke=["id"],Ze=D({__name:"OmenComp",props:{omen:{type:oe,default:null}},setup(s){const e=s,n=w(),{getAltarActiveOmens:p,turn:_}=P(n),g=c(()=>e.omen?e.omen.getID():""),m=c(()=>n.playerForID(e.omen.player)),v=c(()=>n.getPlayerFortunes(e.omen.player)),b=c(()=>p.value.includes(e.omen)),d=c(()=>b.value&&_.value===ae.Collect),h=c(()=>{var t;return m.value&&!((t=m.value)!=null&&t.turn)}),C=c(()=>v.value.find(t=>t.includes(e.omen)));K(()=>{J(()=>{$()})});function $(){const t=document.getElementById(`style-${e.omen.getID()}`);if(!t)return;const a=`${e.omen.celestial}${e.omen.sacrifice}`,l=new URL(Object.assign({"../assets/images/omens/11.png":Ee,"../assets/images/omens/12.png":Te,"../assets/images/omens/13.png":Ae,"../assets/images/omens/14.png":Se,"../assets/images/omens/21.png":Me,"../assets/images/omens/22.png":ze,"../assets/images/omens/23.png":Re,"../assets/images/omens/24.png":Fe,"../assets/images/omens/31.png":Ve,"../assets/images/omens/32.png":Le,"../assets/images/omens/33.png":Xe,"../assets/images/omens/34.png":Ye,"../assets/images/omens/41.png":je,"../assets/images/omens/42.png":He,"../assets/images/omens/43.png":Ue,"../assets/images/omens/44.png":Ge})[`../assets/images/omens/${a}.png`],self.location).href;t.style.backgroundImage=`url(${l})`}function x(){d.value&&n.selectOmen(e.omen)}return(t,a)=>(o(),i("div",{id:g.value,class:R(["container shadow flex-column-center",[C.value?"fortune":"",d.value?"events":""]])},[u("div",{class:R(["omen",b.value?"active":"",d.value?"enabled":"",h.value?"disabled":""]),onClick:x},[u("div",{id:`style-${g.value}`,class:"icon"},null,8,Ke)],2)],10,Ne))}});const qe=T(Ze,[["__scopeId","data-v-927d2a68"]]),We="/assets/11-461f6737.png",Je="/assets/12-9ab4812f.png",Qe="/assets/13-5e2b2069.png",es="/assets/14-b76ea213.png",ss="/assets/21-c2aa472a.png",ts="/assets/22-8d6ff469.png",ns="/assets/23-e994e76f.png",os="/assets/24-8dd44e66.png",as="/assets/31-740a3fab.png",ls="/assets/32-25b8eb1c.png",cs="/assets/33-df12b272.png",rs="/assets/34-f4a1c50b.png",is="/assets/41-967a0aaf.png",_s="/assets/42-6d441022.png",fs="/assets/43-11b99e1a.png",gs="/assets/44-a29e51e7.png",us="/assets/flame-e9cdbf27.gif",ds=s=>(j("data-v-ed4c94ba"),s=s(),H(),s),ps=["id"],ms=["id"],vs={key:0,class:"flame"},ys=ds(()=>u("img",{src:us,alt:"burning"},null,-1)),bs=[ys],hs=D({__name:"OfferingComp",props:{offering:{type:le,default:null},tilted:{type:Boolean,defaut:!1}},setup(s){const e=s,n=w(),{getAltarOfferingPlaces:p,getAltarPortentOfferings:_,getEnabledOfferings:g,getDisabledOfferings:m,getBurnableOfferings:v}=P(n),b=c(()=>e.offering?e.offering.getID():""),d=c(()=>_.value.includes(e.offering)),h=c(()=>g.value.includes(e.offering)),C=c(()=>m.value.includes(e.offering)),$=c(()=>v.value.includes(e.offering)),x=c(()=>d.value&&!$.value);K(()=>{J(()=>{t()})});function t(){const y=document.getElementById(`style-${e.offering.getID()}`);if(!y)return;const B=`${e.offering.celestial}${e.offering.sacrifice}`,S=new URL(Object.assign({"../assets/images/offerings/front/11.png":We,"../assets/images/offerings/front/12.png":Je,"../assets/images/offerings/front/13.png":Qe,"../assets/images/offerings/front/14.png":es,"../assets/images/offerings/front/21.png":ss,"../assets/images/offerings/front/22.png":ts,"../assets/images/offerings/front/23.png":ns,"../assets/images/offerings/front/24.png":os,"../assets/images/offerings/front/31.png":as,"../assets/images/offerings/front/32.png":ls,"../assets/images/offerings/front/33.png":cs,"../assets/images/offerings/front/34.png":rs,"../assets/images/offerings/front/41.png":is,"../assets/images/offerings/front/42.png":_s,"../assets/images/offerings/front/43.png":fs,"../assets/images/offerings/front/44.png":gs})[`../assets/images/offerings/front/${B}.png`],self.location).href;y.style.backgroundImage=`url(${S})`}function a(){C.value||h.value&&n.selectOffering(e.offering)}let l=new ce,r="";function f(){if(e.offering.zone!==z.Player)return;const y=document.getElementById(`${e.offering.getID()}`);y&&(l.setX(y.offsetLeft),l.setY(y.offsetTop),r=y.style.transform,e.offering.setHolding(!0))}function O(y){const B=y.touches[0];B&&A(B.clientX,B.clientY)}function k(y){A(y.clientX,y.clientY)}function A(y,B){const S=e.offering||null;if(!S||S.zone!==z.Player)return;const X=document.getElementById(`${S.getID()}`);if(!X)return;X.style.top=`${l.y}px`,X.style.left=`${l.x}px`,X.style.transform=r,n.resetOfferings();const Y=p.value.find(ee=>{var Z;return(Z=document.getElementById(`${ee.getID()}`))==null?void 0:Z.containsPoint(y,B)});Y&&n.pushOfferingAtPlace(Y,S.direction),Y&&n.dropOffering(Y),S.setHolding(!1)}return(y,B)=>(o(),i("div",{id:b.value,class:R(["container shadow flex-column-center",h.value?"events":""])},[u("div",{class:R(["offering",[x.value?"active":"",h.value?"enabled":"",C.value?"disabled":"",$.value?"burner":"",s.offering.burning?"burning":""]]),onClick:a,onTouchstart:f,onMousedown:f,onTouchend:O,onMouseup:k},[u("div",{id:`style-${b.value}`,class:"icon"},null,8,ms),s.offering.burning?(o(),i("div",vs,bs)):W("",!0)],34)],10,ps))}});const $s=T(hs,[["__scopeId","data-v-ed4c94ba"]]),Os=D({__name:"TilesComp",setup(s){const e=w(),{omens:n,offerings:p,getAltarOfferingPlaces:_,getHeldOffering:g}=P(e);function m(a){const l=a.touches[0];l&&b(l.clientX,l.clientY)}function v(a){b(a.clientX,a.clientY)}function b(a,l){const r=g.value||null;if(!r||r.zone!==z.Player||!r.holding)return;const f=document.getElementById(`${r.getID()}`);if(!f)return;const O=l-f.offsetHeight/2,k=a-f.offsetWidth/2;f.style.transition="all 0s ease 0s",f.style.transform="rotate(0) translate(0, 0)",f.style.top=`${O}px`,f.style.left=`${k}px`;const A=r.direction;x(a,l),r.direction!==A&&e.resetOfferings(),t()}let d=0,h=0,C=5,$=0;function x(a,l){if($++,$>C)$=0;else return;const r=g.value||null;if(r){if(d&&h){const f=a-d,O=l-h;Math.abs(f)>Math.abs(O)?r.setDirection(f>0?2:4):r.setDirection(O>0?3:1)}d=a,h=l}}function t(){const a=g.value||null;if(!a)return;const l=document.getElementById(`${a.getID()}`);if(!l)return;const r=l.getBoundingClientRect(),f=_.value.filter(O=>{var A;const k=((A=document.getElementById(O.getID()))==null?void 0:A.getBoundingClientRect())||new DOMRect;return!(r.right<k.left||r.left>k.right||r.bottom<k.top||r.top>k.bottom)});_.value.filter(O=>f.includes(O)).forEach(O=>e.pushOfferingAtPlace(O,a.direction))}return(a,l)=>(o(),i("div",{class:"tiles",onTouchmove:m,onMousemove:v},[(o(!0),i(F,null,V(I(n),(r,f)=>(o(),L(qe,{key:f,omen:r},null,8,["omen"]))),128)),(o(!0),i(F,null,V(I(p),(r,f)=>(o(),L($s,{key:f,offering:r},null,8,["offering"]))),128))],32))}});const Is=T(Os,[["__scopeId","data-v-9bd9d9ed"]]),Q=s=>(j("data-v-3dfd360e"),s=s(),H(),s),xs={class:"flex-row-spaced window-height"},Cs=Q(()=>u("div",null,null,-1)),Ds={class:"flex-column-spaced"},ws=Q(()=>u("div",null,null,-1)),Ps=D({__name:"GameView",setup(s){const e=w(),{players:n,getCurrentPlayerTurn:p}=P(e);return K(()=>{e.gameStart()}),re(()=>{e.gameEnd()}),(_,g)=>(o(),i("main",{class:R(I(p)?"":"waiting")},[E(ie,{bg:"game.jpeg"}),u("div",xs,[Cs,E(q,{player:I(n)[0]},null,8,["player"]),u("div",Ds,[E(he),E(Ce),E(Be)]),E(q,{player:I(n)[1]},null,8,["player"]),ws]),E(Is)],2))}});const Es=T(Ps,[["__scopeId","data-v-3dfd360e"]]);export{Es as default};
